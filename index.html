<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Mining Simulator</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --primary: #6a11cb;
            --secondary: #2575fc;
            --accent: #f9c74f;
            --dark: #1a1a2e;
            --darker: #0f3460;
            --success: #4cc9f0;
            --danger: #f94144;
            --text: #e6e6e6;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: var(--dark);
            color: var(--text);
            padding: 10px;
            line-height: 1.6;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: var(--darker);
            border-radius: 10px;
            margin-bottom: 10px;
        }
        
        .logo {
            font-weight: bold;
            color: var(--accent);
        }
        
        .balance {
            font-weight: bold;
            color: var(--accent);
        }
        
        .section {
            background: var(--darker);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 10px;
        }
        
        .section-title {
            color: var(--success);
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .mining-rig {
            text-align: center;
        }
        
        .equipment-image {
            width: 150px;
            height: 100px;
            object-fit: contain;
            margin: 10px auto;
            background: rgba(0,0,0,0.3);
            border-radius: 5px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 10px 0;
        }
        
        .stat {
            background: rgba(0,0,0,0.2);
            padding: 5px;
            border-radius: 5px;
            text-align: center;
        }
        
        .stat-value {
            font-weight: bold;
            color: var(--accent);
        }
        
        .mine-btn {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            width: 100%;
            font-weight: bold;
            margin-top: 10px;
            cursor: pointer;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 10px;
        }
        
        .tab {
            padding: 5px 10px;
            cursor: pointer;
        }
        
        .tab.active {
            border-bottom: 2px solid var(--accent);
            color: var(--accent);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .upgrade {
            display: flex;
            background: rgba(0,0,0,0.2);
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 5px;
            align-items: center;
        }
        
        .upgrade-info {
            flex: 1;
        }
        
        .upgrade-name {
            font-weight: bold;
        }
        
        .upgrade-btn {
            background: var(--success);
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            color: white;
            cursor: pointer;
        }
        
        .upgrade-btn:disabled {
            background: #666;
            cursor: not-allowed;
        }
        
        .shop-item {
            display: flex;
            background: rgba(0,0,0,0.2);
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 5px;
            align-items: center;
        }
        
        .shop-item-btn {
            background: var(--primary);
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            color: white;
            cursor: pointer;
        }
        
        .notification {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            z-index: 100;
            animation: fadeInOut 3s;
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; top: 0; }
            10% { opacity: 1; top: 10px; }
            90% { opacity: 1; top: 10px; }
            100% { opacity: 0; top: 0; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">üí∞ Mining Sim</div>
        <div class="balance" id="balance">0 BTC</div>
    </div>
    
    <div class="section">
        <div class="section-title">‚õèÔ∏è –í–∞—à–∞ –º–∞–π–Ω–∏–Ω–≥ —Ñ–µ—Ä–º–∞</div>
        <div class="mining-rig">
            <img id="equipment-image" class="equipment-image" src="https://i.imgur.com/JVY9FQa.png">
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="mining-power">1</div>
                    <div>–ú–æ—â–Ω–æ—Å—Ç—å</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="energy">100%</div>
                    <div>–≠–Ω–µ—Ä–≥–∏—è</div>
                </div>
            </div>
            <button class="mine-btn" id="mine-btn">–ú–ê–ô–ù–ò–¢–¨</button>
        </div>
    </div>
    
    <div class="section">
        <div class="tabs">
            <div class="tab active" data-tab="upgrades">–£–ª—É—á—à–µ–Ω–∏—è</div>
            <div class="tab" data-tab="shop">–ú–∞–≥–∞–∑–∏–Ω</div>
            <div class="tab" data-tab="stats">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
        </div>
        
        <div class="tab-content active" id="upgrades-tab">
            <div id="upgrades-list"></div>
        </div>
        
        <div class="tab-content" id="shop-tab">
            <div id="shop-items"></div>
        </div>
        
        <div class="tab-content" id="stats-tab">
            <div class="stat">
                <div class="stat-value" id="total-mined">0</div>
                <div>–í—Å–µ–≥–æ –¥–æ–±—ã—Ç–æ</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="play-time">0</div>
                <div>–í—Ä–µ–º—è –∏–≥—Ä—ã</div>
            </div>
        </div>
    </div>
    
    <script>
        // –ò–≥—Ä–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        const gameData = {
            upgrades: [
                {
                    id: 'gpu',
                    name: '–í–∏–¥–µ–æ–∫–∞—Ä—Ç–∞',
                    image: 'https://i.imgur.com/JVY9FQa.png',
                    levels: [
                        { cost: 100, power: 2 },
                        { cost: 250, power: 3 },
                        { cost: 500, power: 5 },
                        { cost: 1000, power: 8 },
                        { cost: 2000, power: 12 }
                    ]
                },
                {
                    id: 'asic',
                    name: 'ASIC –º–∞–π–Ω–µ—Ä',
                    image: 'https://i.imgur.com/8QZQZQZ.png',
                    levels: [
                        { cost: 5000, power: 20 },
                        { cost: 10000, power: 35 },
                        { cost: 20000, power: 50 }
                    ]
                },
                {
                    id: 'cooling',
                    name: '–û—Ö–ª–∞–∂–¥–µ–Ω–∏–µ',
                    image: 'https://i.imgur.com/4QZQZQZ.png',
                    levels: [
                        { cost: 300, energy: 10 },
                        { cost: 700, energy: 15 },
                        { cost: 1500, energy: 20 }
                    ]
                }
            ],
            shopItems: [
                {
                    id: 'energy',
                    name: '–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫',
                    description: '+20 —ç–Ω–µ—Ä–≥–∏–∏',
                    cost: 50,
                    effect: (game) => { game.state.energy = Math.min(game.state.energy + 20, 100); }
                },
                {
                    id: 'energy-upgrade',
                    name: '–ë–ª–æ–∫ –ø–∏—Ç–∞–Ω–∏—è',
                    description: '+50 –∫ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏',
                    cost: 200,
                    effect: (game) => { game.state.maxEnergy += 50; game.state.energy = game.state.maxEnergy; }
                }
            ]
        };

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        class Game {
            constructor() {
                this.state = {
                    balance: 0,
                    totalMined: 0,
                    miningPower: 1,
                    energy: 100,
                    maxEnergy: 100,
                    playTime: 0,
                    lastUpdate: Date.now(),
                    equipment: {
                        gpu: { level: 0 },
                        asic: { level: 0, owned: false },
                        cooling: { level: 0 }
                    }
                };
                
                this.load();
                this.initTelegram();
                this.initUI();
                this.initGameLoop();
            }
            
            initTelegram() {
                this.tg = window.Telegram.WebApp;
                this.tg.expand();
                
                if (this.tg.initDataUnsafe.user) {
                    const user = this.tg.initDataUnsafe.user;
                    this.userId = user.id;
                    this.username = user.username || `${user.first_name}${user.last_name ? ' ' + user.last_name : ''}`;
                }
            }
            
            initUI() {
                // –≠–ª–µ–º–µ–Ω—Ç—ã UI
                this.ui = {
                    balance: document.getElementById('balance'),
                    miningPower: document.getElementById('mining-power'),
                    energy: document.getElementById('energy'),
                    totalMined: document.getElementById('total-mined'),
                    playTime: document.getElementById('play-time'),
                    mineBtn: document.getElementById('mine-btn'),
                    equipmentImage: document.getElementById('equipment-image'),
                    upgradesList: document.getElementById('upgrades-list'),
                    shopItems: document.getElementById('shop-items'),
                    tabs: document.querySelectorAll('.tab'),
                    tabContents: document.querySelectorAll('.tab-content')
                };
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
                this.ui.mineBtn.addEventListener('click', () => this.mine());
                
                this.ui.tabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        const tabId = tab.getAttribute('data-tab');
                        this.switchTab(tabId);
                    });
                });
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–∫–ª–∞–¥–æ–∫
                this.renderUpgrades();
                this.renderShop();
                this.updateUI();
            }
            
            initGameLoop() {
                setInterval(() => {
                    this.state.playTime++;
                    this.updateUI();
                    this.save();
                }, 1000);
            }
            
            switchTab(tabId) {
                this.ui.tabs.forEach(tab => {
                    if (tab.getAttribute('data-tab') === tabId) {
                        tab.classList.add('active');
                    } else {
                        tab.classList.remove('active');
                    }
                });
                
                this.ui.tabContents.forEach(content => {
                    if (content.id === `${tabId}-tab`) {
                        content.classList.add('active');
                    } else {
                        content.classList.remove('active');
                    }
                });
            }
            
            mine() {
                if (this.state.energy > 0) {
                    const mined = this.state.miningPower / 10;
                    this.state.balance += mined;
                    this.state.totalMined += mined;
                    this.state.energy -= 1;
                    
                    this.showNotification(`+${mined.toFixed(2)} BTC`);
                    this.updateUI();
                    this.save();
                } else {
                    this.showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏!');
                }
            }
            
            upgrade(upgradeId) {
                const upgrade = gameData.upgrades.find(u => u.id === upgradeId);
                const currentLevel = this.state.equipment[upgradeId].level;
                const nextLevel = upgrade.levels[currentLevel];
                
                if (nextLevel && this.state.balance >= nextLevel.cost) {
                    this.state.balance -= nextLevel.cost;
                    this.state.equipment[upgradeId].level++;
                    
                    if (upgradeId === 'asic' && currentLevel === 0) {
                        this.state.equipment.asic.owned = true;
                        this.ui.equipmentImage.src = upgrade.image;
                    }
                    
                    if (nextLevel.power) {
                        this.state.miningPower += nextLevel.power;
                    }
                    
                    if (nextLevel.energy) {
                        this.state.maxEnergy += nextLevel.energy;
                        this.state.energy = this.state.maxEnergy;
                    }
                    
                    this.showNotification(`–£–ª—É—á—à–µ–Ω–æ: ${upgrade.name} ${this.state.equipment[upgradeId].level} —É—Ä.`);
                    this.renderUpgrades();
                    this.updateUI();
                    this.save();
                } else {
                    this.showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ BTC!');
                }
            }
            
            buyShopItem(itemId) {
                const item = gameData.shopItems.find(i => i.id === itemId);
                
                if (this.state.balance >= item.cost) {
                    this.state.balance -= item.cost;
                    item.effect(this);
                    this.showNotification(`–ö—É–ø–ª–µ–Ω–æ: ${item.name}`);
                    this.updateUI();
                    this.save();
                } else {
                    this.showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ BTC!');
                }
            }
            
            updateUI() {
                this.ui.balance.textContent = `${this.state.balance.toFixed(2)} BTC`;
                this.ui.miningPower.textContent = this.state.miningPower.toFixed(1);
                this.ui.energy.textContent = `${Math.floor((this.state.energy / this.state.maxEnergy) * 100)}%`;
                this.ui.totalMined.textContent = this.state.totalMined.toFixed(2);
                
                const hours = Math.floor(this.state.playTime / 3600);
                const minutes = Math.floor((this.state.playTime % 3600) / 60);
                const seconds = this.state.playTime % 60;
                this.ui.playTime.textContent = `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            renderUpgrades() {
                this.ui.upgradesList.innerHTML = '';
                
                gameData.upgrades.forEach(upgrade => {
                    const currentLevel = this.state.equipment[upgrade.id].level;
                    const nextLevel = upgrade.levels[currentLevel];
                    
                    if (nextLevel || (upgrade.id === 'asic' && !this.state.equipment.asic.owned)) {
                        const upgradeEl = document.createElement('div');
                        upgradeEl.className = 'upgrade';
                        
                        const canAfford = this.state.balance >= (nextLevel ? nextLevel.cost : upgrade.levels[0].cost);
                        
                        upgradeEl.innerHTML = `
                            <div class="upgrade-info">
                                <div class="upgrade-name">${upgrade.name} ${currentLevel > 0 ? `(${currentLevel} —É—Ä.)` : ''}</div>
                                ${nextLevel ? `
                                    <div>–°—Ç–æ–∏–º–æ—Å—Ç—å: ${nextLevel.cost} BTC</div>
                                    ${nextLevel.power ? `<div>+${nextLevel.power} –º–æ—â–Ω–æ—Å—Ç–∏</div>` : ''}
                                    ${nextLevel.energy ? `<div>+${nextLevel.energy} —ç–Ω–µ—Ä–≥–∏–∏</div>` : ''}
                                ` : `
                                    <div>–°—Ç–æ–∏–º–æ—Å—Ç—å: ${upgrade.levels[0].cost} BTC</div>
                                    <div>–†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç ${upgrade.name}</div>
                                `}
                            </div>
                            <button class="upgrade-btn" ${canAfford ? '' : 'disabled'}>
                                ${nextLevel ? '–£–ª—É—á—à–∏—Ç—å' : '–ö—É–ø–∏—Ç—å'}
                            </button>
                        `;
                        
                        upgradeEl.querySelector('button').addEventListener('click', () => this.upgrade(upgrade.id));
                        this.ui.upgradesList.appendChild(upgradeEl);
                    }
                });
            }
            
            renderShop() {
                this.ui.shopItems.innerHTML = '';
                
                gameData.shopItems.forEach(item => {
                    const shopItemEl = document.createElement('div');
                    shopItemEl.className = 'shop-item';
                    
                    const canAfford = this.state.balance >= item.cost;
                    
                    shopItemEl.innerHTML = `
                        <div class="upgrade-info">
                            <div class="upgrade-name">${item.name}</div>
                            <div>${item.description}</div>
                            <div>${item.cost} BTC</div>
                        </div>
                        <button class="shop-item-btn" ${canAfford ? '' : 'disabled'}>
                            –ö—É–ø–∏—Ç—å
                        </button>
                    `;
                    
                    shopItemEl.querySelector('button').addEventListener('click', () => this.buyShopItem(item.id));
                    this.ui.shopItems.appendChild(shopItemEl);
                });
            }
            
            showNotification(message) {
                const notification = document.createElement('div');
                notification.className = 'notification';
                notification.textContent = message;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 3000);
            }
            
            save() {
                localStorage.setItem('miningSimulatorSave', JSON.stringify(this.state));
            }
            
            load() {
                const saved = localStorage.getItem('miningSimulatorSave');
                if (saved) {
                    this.state = JSON.parse(saved);
                    
                    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ –∑–∞ –≤—Ä–µ–º—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è
                    const now = Date.now();
                    const diffHours = (now - this.state.lastUpdate) / (1000 * 60 * 60);
                    this.state.energy = Math.min(this.state.energy + diffHours * 5, this.state.maxEnergy);
                    this.state.lastUpdate = now;
                }
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        const game = new Game();
    </script>
</body>
</html>
